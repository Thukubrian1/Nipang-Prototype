<div class="dashboard-container">
  <!-- Sidebar -->
  <app-sidebar 
    [isOpen]="isSidebarOpen" 
    (toggleSidebar)="handleSidebarToggle()">
  </app-sidebar>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Top Bar -->
    <app-topbar
      [adminName]="adminName"
      [role]="role"
      [userAvatar]="userAvatar"
      (searchQuery)="handleSearch($event)">
    </app-topbar>

    <!-- System Roles Content -->
    <div class="roles-content">
      
      <!-- Tabs Navigation -->
      <div class="tabs-navigation">
        <button 
          class="tab-button" 
          [class.active]="activeTab === 'roles'"
          (click)="switchTab('roles')">
          Roles
        </button>
        <button 
          class="tab-button" 
          [class.active]="activeTab === 'reasons'"
          (click)="switchTab('reasons')">
          Reasons
        </button>

        <!-- Search Bar -->
        <div class="tab-search">
          <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"></circle>
            <path d="m21 21-4.35-4.35"></path>
          </svg>
          <select class="search-dropdown" [(ngModel)]="searchBy">
            <option *ngIf="activeTab === 'roles'" value="role">Role</option>
            <option *ngIf="activeTab === 'roles'" value="status">Status</option>
            <option *ngIf="activeTab === 'reasons'" value="reason">Reason</option>
            <option *ngIf="activeTab === 'reasons'" value="type">Type</option>
            <option *ngIf="activeTab === 'reasons'" value="status">Status</option>
          </select>
          <input 
            type="text" 
            [placeholder]="activeTab === 'roles' ? 'Search by role, status...' : 'Search by reason, type...'" 
            class="search-input"
            [(ngModel)]="searchQuery">
        </div>
      </div>

      <!-- Tab Content -->
      <div class="tab-content">
        
        <!-- Roles Tab -->
        <div *ngIf="activeTab === 'roles'" class="roles-tab">
          <div class="section-header">
            <div>
              <h2 class="section-title">System Roles</h2>
              <p class="section-subtitle">Create and manage access to the admin dashboard by Creating Roles and Permissions.</p>
            </div>
            <button class="btn-primary" (click)="addSystemRole()">Add System Role</button>
          </div>

          <!-- Stats Cards -->
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-header">
                <h3>Total Roles</h3>
                <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                  <line x1="16" y1="2" x2="16" y2="6"></line>
                  <line x1="8" y1="2" x2="8" y2="6"></line>
                  <line x1="3" y1="10" x2="21" y2="10"></line>
                </svg>
              </div>
              <div class="stat-value">{{totalRoles}}</div>
            </div>

            <div class="stat-card">
              <div class="stat-header">
                <h3>Active</h3>
                <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                  <line x1="16" y1="2" x2="16" y2="6"></line>
                  <line x1="8" y1="2" x2="8" y2="6"></line>
                  <line x1="3" y1="10" x2="21" y2="10"></line>
                </svg>
              </div>
              <div class="stat-value">{{activeRoles}}</div>
            </div>

            <div class="stat-card">
              <div class="stat-header">
                <h3>Inactive</h3>
                <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                  <line x1="16" y1="2" x2="16" y2="6"></line>
                  <line x1="8" y1="2" x2="8" y2="6"></line>
                  <line x1="3" y1="10" x2="21" y2="10"></line>
                </svg>
              </div>
              <div class="stat-value">{{inactiveRoles}}</div>
            </div>
          </div>

          <!-- Roles Table -->
          <div class="data-table">
            <table>
              <thead>
                <tr>
                  <th>Role</th>
                  <th>Assigned Users</th>
                  <th>Last Activity</th>
                  <th>Status</th>
                  <th></th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let role of roles">
                  <td class="role-name">{{role.name}}</td>
                  <td>{{role.assignedUsers}}</td>
                  <td>{{role.lastActivity}}</td>
                  <td>
                    <span class="status-badge" [class.active]="role.status === 'Active'" [class.inactive]="role.status === 'Inactive'">
                      {{role.status}}
                    </span>
                  </td>
                  <td class="actions-cell">
                    <button class="btn-text" (click)="editRole(role.id)">Edit</button>
                    <button class="btn-text delete" (click)="deleteRole(role.id)">Delete</button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Reasons Tab -->
        <div *ngIf="activeTab === 'reasons'" class="reasons-tab">
          <div class="section-header">
            <div>
              <h2 class="section-title">Reasons</h2>
              <p class="section-subtitle">Create and manage reasons as to why users have been suspended, rejected or reinstated</p>
            </div>
            <button class="btn-primary" (click)="addReason()">Add Reason</button>
          </div>

          <!-- Stats Cards -->
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-header">
                <h3>Total Reasons</h3>
                <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                  <line x1="16" y1="2" x2="16" y2="6"></line>
                  <line x1="8" y1="2" x2="8" y2="6"></line>
                  <line x1="3" y1="10" x2="21" y2="10"></line>
                </svg>
              </div>
              <div class="stat-value">{{totalReasons}}</div>
            </div>

            <div class="stat-card">
              <div class="stat-header">
                <h3>Active</h3>
                <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                  <line x1="16" y1="2" x2="16" y2="6"></line>
                  <line x1="8" y1="2" x2="8" y2="6"></line>
                  <line x1="3" y1="10" x2="21" y2="10"></line>
                </svg>
              </div>
              <div class="stat-value">{{activeReasons}}</div>
            </div>

            <div class="stat-card">
              <div class="stat-header">
                <h3>Inactive</h3>
                <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                  <line x1="16" y1="2" x2="16" y2="6"></line>
                  <line x1="8" y1="2" x2="8" y2="6"></line>
                  <line x1="3" y1="10" x2="21" y2="10"></line>
                </svg>
              </div>
              <div class="stat-value">{{inactiveReasons}}</div>
            </div>
          </div>

          <!-- Reasons Table -->
          <div class="data-table">
            <table>
              <thead>
                <tr>
                  <th>Reason</th>
                  <th>Reason Type</th>
                  <th>Applicable To</th>
                  <th>Status</th>
                  <th></th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let reason of reasons">
                  <td class="reason-text">{{reason.reason}}</td>
                  <td>{{reason.type}}</td>
                  <td>{{reason.applicableTo}}</td>
                  <td>
                    <span class="status-badge" [class.active]="reason.status === 'Active'" [class.inactive]="reason.status === 'Inactive'">
                      {{reason.status}}
                    </span>
                  </td>
                  <td class="actions-cell">
                    <button class="btn-text" (click)="editReason(reason.id)">Edit</button>
                    <button class="btn-text delete" (click)="deleteReason(reason.id)">Delete</button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Add/Edit Role Modal -->
<div class="modal-overlay" *ngIf="showRoleModal" (click)="closeRoleModal()">
  <div class="modal-container" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2 class="modal-title">{{ isEditingRole ? 'Edit Role' : 'Add Role' }}</h2>
      <button class="modal-close" (click)="closeRoleModal()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>

    <div class="modal-body">
      <form [formGroup]="roleForm">
        <div class="form-group">
          <label class="form-label">Status</label>
          <select class="form-select" formControlName="status">
            <option value="Active">Active</option>
            <option value="Inactive">Inactive</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label">Role</label>
          <input 
            type="text" 
            class="form-input" 
            placeholder="Enter Role" 
            formControlName="name">
        </div>

        <div class="permissions-group">
          <label class="form-label">Permissions</label>
          <div class="permissions-grid">
            <label class="checkbox-wrapper">
              <input type="checkbox" formControlName="manageUsers">
              <span class="checkbox-label">Manage Users</span>
            </label>
            <label class="checkbox-wrapper">
              <input type="checkbox" formControlName="manageEvents">
              <span class="checkbox-label">Manage Events</span>
            </label>
            <label class="checkbox-wrapper">
              <input type="checkbox" formControlName="viewAnalytics">
              <span class="checkbox-label">View Analytics</span>
            </label>
            <label class="checkbox-wrapper">
              <input type="checkbox" formControlName="systemSettings">
              <span class="checkbox-label">System Settings</span>
            </label>
            <label class="checkbox-wrapper">
              <input type="checkbox" formControlName="createEvents">
              <span class="checkbox-label">Create Events</span>
            </label>
            <label class="checkbox-wrapper">
              <input type="checkbox" formControlName="editEvents">
              <span class="checkbox-label">Edit Events</span>
            </label>
            <label class="checkbox-wrapper">
              <input type="checkbox" formControlName="viewAllEvents">
              <span class="checkbox-label">View All Events</span>
            </label>
            <label class="checkbox-wrapper">
              <input type="checkbox" formControlName="accessAnalytics">
              <span class="checkbox-label">Access Analytics</span>
            </label>
          </div>
        </div>
      </form>
    </div>

    <div class="modal-footer">
      <button class="btn-secondary" (click)="closeRoleModal()">
        {{ isEditingRole ? 'Cancel' : 'Cancel' }}
      </button>
      <button class="btn-save" (click)="saveRole()">
        {{ isEditingRole ? 'Update' : 'Save' }}
      </button>
    </div>
  </div>
</div>

<!-- Delete Role Confirmation Modal -->
<div class="modal-overlay confirmation-modal" *ngIf="showDeleteRoleModal" (click)="closeDeleteRoleModal()">
  <div class="modal-container" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2 class="modal-title">Delete Role</h2>
      <button class="modal-close" (click)="closeDeleteRoleModal()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>

    <div class="confirmation-body">
      <h3 class="confirmation-title">Are you sure you want to delete this Role?</h3>
      <p class="confirmation-message">
        On deleting the role, the admins assigned will not have access to the admin dashboard.
      </p>
      <div class="confirmation-actions">
        <button class="btn-cancel" (click)="closeDeleteRoleModal()">NO</button>
        <button class="btn-confirm btn-delete-confirm" (click)="confirmDeleteRole()">YES</button>
      </div>
    </div>
  </div>
</div>

<!-- Add/Edit Reason Modal -->
<div class="modal-overlay" *ngIf="showReasonModal" (click)="closeReasonModal()">
  <div class="modal-container" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2 class="modal-title">{{ isEditingReason ? 'Edit Reason' : 'Reason' }}</h2>
      <button class="modal-close" (click)="closeReasonModal()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>

    <div class="modal-body">
      <form [formGroup]="reasonForm">
        <div class="form-group">
          <label class="form-label">Reason</label>
          <input 
            type="text" 
            class="form-input" 
            placeholder="Enter Reason" 
            formControlName="reason">
        </div>

        <div class="form-group">
          <label class="form-label">Reason Type</label>
          <select class="form-select" formControlName="type">
            <option value="">Select Reason Type</option>
            <option value="Rejection">Rejection</option>
            <option value="Suspension">Suspension</option>
            <option value="Reinstating">Reinstating</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label">Applicable To</label>
          <select class="form-select" formControlName="applicableTo">
            <option value="">Select who it is applicable to</option>
            <option value="All Users">All Users</option>
            <option value="Admin User">Admin User</option>
            <option value="Service Providers">Service Providers</option>
            <option value="Regular Users">Regular Users</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label">Status</label>
          <select class="form-select" formControlName="status">
            <option value="">Select Status</option>
            <option value="Active">Active</option>
            <option value="Inactive">Inactive</option>
          </select>
        </div>
      </form>
    </div>

    <div class="modal-footer">
      <button class="btn-secondary" (click)="closeReasonModal()">Cancel</button>
      <button class="btn-save" (click)="saveReason()">
        {{ isEditingReason ? 'Update' : 'Save' }}
      </button>
    </div>
  </div>
</div>

<!-- Delete Reason Confirmation Modal -->
<div class="modal-overlay confirmation-modal" *ngIf="showDeleteReasonModal" (click)="closeDeleteReasonModal()">
  <div class="modal-container" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2 class="modal-title">Delete Reason</h2>
      <button class="modal-close" (click)="closeDeleteReasonModal()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>

    <div class="confirmation-body">
      <h3 class="confirmation-title">Are you sure you want to delete this Reason?</h3>
      <p class="confirmation-message">
        On deleting the reason, it will not be visible when rejecting, suspending or reinstating.
      </p>
      <div class="confirmation-actions">
        <button class="btn-cancel" (click)="closeDeleteReasonModal()">NO</button>
        <button class="btn-confirm btn-delete-confirm" (click)="confirmDeleteReason()">YES</button>
      </div>
    </div>
  </div>
</div>

      </div>
    </div>
  </main>
</div>